function onDeviceReady(){pictureSource=navigator.camera.PictureSourceType,destinationType=navigator.camera.DestinationType}function onPhotoDataSuccess(e){var t=document.getElementById("smallImage");t.style.display="block",t.src="data:image/jpeg;base64,"+e}function onPhotoURISuccess(e){var t=document.getElementById("largeImage");t.style.display="block",t.src=e}function capturePhoto(){navigator.camera.getPicture(onPhotoDataSuccess,onFail,{quality:50,destinationType:destinationType.DATA_URL})}function capturePhotoEdit(){navigator.camera.getPicture(onPhotoDataSuccess,onFail,{quality:20,allowEdit:!0,destinationType:destinationType.DATA_URL})}function getPhoto(e){navigator.camera.getPicture(onPhotoURISuccess,onFail,{quality:50,destinationType:destinationType.FILE_URI,sourceType:e})}function onFail(e){alert("Failed because: "+e)}var interact={user:{check:function(e,t){console.log(e),$.post("https://app.wathebikaande.eu/api/request.php",{type:"user",authCode:e},function(e,a){return t(),e})},postStatupChoices:function(e,t,a,n){$.post("https://app.wathebikaande.eu/api/request.php",{type:"startups",authCode:e,startups:t,stage:2},function(e,t){return console.log(e),n&&n(),e})},getStartupChoices:function(e){}}},keypad={el:{},keys:{key:"",typed:0},commingFrom:"",callback:"",setup:function(e,t){console.log("initiated keypad"),keypad.commingFrom=function(){"stage"+e.stage.setup()},keypad.callback=t,keypad.renderKeypad(e)},renderKeypad:function(e){app.getTemplate("keypad",function(t){console.log("rendering keypad template");var a={};if(e.fadeIn&&(a.hidden=!0),app.el.template.html(t(a)),keypad.assignSelectors(),keypad.watchKeys(),e.fadeIn){var n=0;keypad.el.keys.addClass("hidden"),keypad.el.keys.each(function(){var e=$(this);setTimeout(function(){e.removeClass("hidden")},10*n),n++}),keypad.el.keypad.fadeIn("fast")}})},assignSelectors:function(){keypad.el.keypad=$(".keypad"),keypad.el.keys=$(".keypad .key"),keypad.el.resultBox=$(".keypad .result")},watchKeys:function(){console.log("watching keypad keys"),keypad.el.keys.click(function(){var e=$(this),t=e.data("num");console.log("pressed key "+t),keypad.handleKeyPress(t),3===keypad.keys.typed&&(console.log("3 characters entered, check if user can continue"),keypad.handleSubmit())})},handleKeyPress:function(e){console.log("handling key "+e),keypad.ifUndo(e)?keypad.undoNumber():keypad.ifCancel(e)?keypad.el.keypad.fadeOut("fast",function(){keypad.commingFrom()}):keypad.newNumber(e)},ifUndo:function(e){return"undo"===e},ifCancel:function(e){return"cancel"===e},undoNumber:function(){console.log("Undoing last keypress"),keypad.keys.typed>0&&(keypad.keys.typed--,keypad.keys.key=keypad.keys.key.substring(0,keypad.keys.key.length-1),keypad.el.resultBox.children().last().remove())},newNumber:function(e){keypad.keys.typed<3&&(console.log("Adding new number"),keypad.el.resultBox.append("<span>"+e+"</span>"),keypad.keys.key+=e,keypad.keys.typed++)},hideKeys:function(){var e=0;keypad.el.keys.each(function(){var t=$(this);setTimeout(function(){t.addClass("hidden")},10*e),e++})},handleSubmit:function(){keypad.hideKeys(),keypad.el.resultBox.addClass("loading");var e=interact.user.check(keypad.keys.key,function(){app.session.authCode=keypad.keys.key,keypad.callback&&keypad.callback(e)})},quit:function(){keypad.el.keypad.fadeOut("fast")}},video={el:{},setup:function(e){video.el.video=document.getElementById(e),video.click(),video.el.playBtn=$("#play"),video.el.pauseBtn=$("#pause"),video.el.replayBtn=$("#replay"),video.el.cta=$(".belowPopup")},click:function(){var e=null!==document.ontouchstart?"click":"touchstart",t=video.el.video;t.addEventListener(e,function(){video.el.replayBtn.fadeOut(),video.el.cta.fadeOut(),1==t.paused?(console.log("videoIsPaused"),video.el.pauseBtn.fadeOut(),video.el.playBtn.fadeIn().delay(300).fadeOut(),t.play()):(console.log("videoIsPlaying"),video.el.pauseBtn.fadeIn(),t.pause())}),t.addEventListener("ended",function(){video.el.replayBtn.fadeIn(),video.el.cta.fadeIn()},!1)}},map={el:{},setup:function(){map.loadTemplate()},loadTemplate:function(){app.getTemplate("map",function(e){app.el.template.html(e),map.createMapJSON(),map.el.text=$("#text"),map.el.map=$("#map")})},stateNames:[],stateText:[],stateModes:[],countryPaths:[],createMapJSON:function(){function e(){var e=new ScaleRaphael("map",646,654),n={fill:"#d9d9d9",cursor:"pointer",stroke:"#24221f","stroke-width":1,"stroke-linejoin":"round"},o=[];for(var s in paths){var i=e.path(paths[s].path);i.attr(n),o[i.id]=s,"OFF"==map.stateModes[i.id]?i.attr({fill:"#ccc",cursor:"default"}):i.attr({fill:a[i.id],d:"300"})}t(e)}function t(e){var t=.65*$(window).width(),a=.9*$(window).height();e.changeSize(t,a,!0,!1)}var a=[];$.getJSON("assets/data/mapData.json",function(t){app.getTemplate("popup",function(e){var t={title:"Europa",body:"Kies een land aan de linkerzijde",button:{text:"hi",action:"stage2.postStartups()"}};console.dir(t),map.el.text.html(e(t))});var n=0;$.each(t.stateData,function(e){var t=this;"ON"==t.stateMode&&n++,map.stateText.push(t.startups),map.stateNames.push(t.stateName),map.stateModes.push(t.stateMode),a.push("#"+t.stateColor)}),e(),map.animateMap()})},animateMap:function(){function e(){setTimeout(function(){$("#"+map.stateNames[n].replace(/\s+/g,"")).attr("data-grown","true"),n++,38>n&&e()},100)}map.countriePaths=map.el.map.find("path");var t={},a=0,n=0;map.countriePaths.each(function(){var e=$(this);t[map.stateNames[a]]={top:e.offset().top,left:e.offset().left},e.attr("id",map.stateNames[a].replace(/\s+/g,"")),e.attr("data-active","false"),a++}),e(),setTimeout(function(){map.getStartups()},100)},countryClick:function(){map.countriePaths.click(function(){var e=$(this),t=e.index()-2;"ON"===map.stateModes[t]&&(map.countriePaths.each(function(){$(this).attr("data-active","false")}),e.attr("data-active","true"),app.getTemplate("popup",function(e){var a={title:map.stateNames[t],startups:map.stateText[t]};console.dir(a),map.el.text.html(e(a));var n=0;$(".startup").each(function(){var e=$(this),t={x:e.offset().left,y:e.offset().top,width:e.outerWidth(),height:e.outerHeight()};1==n&&(t.x+=t.width),e.css({top:t.y,left:t.x,width:t.width,height:t.height,position:"absolute"}),e.click(function(){$(this).hasClass("open")||map.openModal(e.attr("id"))}),n++})}))})},openModal:function(e){var t=$("#"+e),a={left:t.offset().left,top:t.offset().top,width:t.outerWidth(),height:t.outerHeight()};t.addClass("open");var n=$('<button class="close">Sluiten</button>').click(function(t){t.stopPropagation(),map.closeModal(e,a)});setTimeout(function(){t.find("h4, .linken").fadeIn("fast"),t.find(".content").fadeIn("fast"),t.append(n)},1e3)},closeModal:function(e,t){var a=$("#"+e);a.removeClass("open"),a.find("h4, .linken, .content, .close").fadeOut("fast")},getStartups:function(){$.getJSON("assets/data/startups.json",map.locateStartups)},locateStartups:function(e){$.each(e,function(){var e=this.country,t=$("#"+e),a={x:t.offset().left,y:t.offset().top,width:t[0].getBBox().width,height:t[0].getBBox().height};map.createMarker(a,this),console.log(a)})},createMarker:function(e,t){app.getTemplate("startupMarker",function(a){var n={top:e.y+e.height/2-20,left:e.x+e.width/2-24,name:t.name,logo:t.logo,id:t.id,content:t.content,category:t.category};app.el.template.append(a(n)),$("#marker-"+t.id).click(function(){map.openModal("marker-"+t.id)}),$("#marker-"+t.id+" .linken").click(function(){$this=$(this),$this.hasClass("selected")?map.removeMarker($this):map.selectMarker($this)})})},selectMarker:function(e){e.addClass("selected");var t=e.attr("data-id");console.log("Adding "+t+"-marker to string"),""==map.selectedStartups?map.selectedStartups=t:map.selectedStartups.indexOf(t)<=-1&&(map.selectedStartups+=","+t),stage2.postStartups()},removeMarker:function(e){var t=e.attr("data-id");console.log("Removing "+t+"-marker from string");var a=map.selectedStartups;a=a.replace(t+",",""),a=a.replace(t,""),map.selectedStartups=a,e.removeClass("selected"),stage2.postStartups()},selectedStartups:""},stages={setup:function(){stages.selectStage()},selectStage:function(){var e=app.getParameters().stage;switch(e=Number(e)){case 1:console.log("It's in stage 1"),stage1.setup();break;case 2:console.log("It's in stage 2"),stage2.setup();break;case 3:console.log("It's in stage 3"),stage3.setup();break;case 4:console.log("It's in stage 4"),stage4.setup();break;case 5:console.log("It's in stage 5"),stage5.setup();break;default:console.log("This stage is not defined"),stages.listStages()}},listStages:function(){app.getTemplate("button",function(e){var t={title:"Kies je stage",body:"Bierrr",buttons:{1:{text:"Stage 1",action:"?stage=1"},2:{text:"Stage 2",action:"?stage=2"},3:{text:"Stage 3",action:"?stage=3"},4:{text:"Stage 4",action:"?stage=4"},5:{text:"Stage 5",action:"?stage=5"},6:{text:"Stage 6",action:"?stage=6"},7:{text:"Stage 7",action:"?stage=7"},8:{text:"Stage 8",action:"?stage=8"}}};app.el.template.html(e(t))})}},stage1={setup:function(){console.log("Setting up stage 1"),stage1.setWelcomeScreen()},setWelcomeScreen:function(){app.getTemplate("popup",function(e){console.log("rendering keypad template");var t={title:"Startup your dream",body:"Welkom bij The European Startup Factory!",button:{text:"START JE STARTUP",action:"stage1.setLogin()"},overlay:!1};app.el.template.html(e(t))})},setLogin:function(){app.login("stage1",function(){stage1.setIntroduction()})},setIntroduction:function(e){app.getTemplate("popup",function(e){var t={video:!0,id:"welcomeVideo",videoSrc:"stage1/stage1.mp4",button:{text:"Ga door naar de volgende koffer",action:"stages.listStages()"}};app.el.template.hide(),app.el.template.html(e(t)),app.el.template.fadeIn(),video.setup("welcomeVideo")})}},stage2={setup:function(){console.log("Setting up stage 1"),stage2.setLogin()},setLogin:function(){app.login("stage2",function(){stage2.setMap()})},setMap:function(){console.log("autcode is: "+app.session.authCode),map.setup()},postStartups:function(){console.log("Choices = "+map.selectedStartups),interact.user.postStatupChoices(app.session.authCode,map.selectedStartups,2)}},stage3={setup:function(){console.log("Setting up stage 3"),stage3.setLogin()},setLogin:function(){console.log("setting up login in stage 3"),app.login("stage3",function(){stage3.chooseBussinessCategory()})},chooseBussinessCategory:function(){app.getTemplate("button",function(e){var t={title:"Kies je bedrijfscategorie",buttons:{1:{text:"3d printing"},2:{text:"Muziek/streaming"},3:{text:"Sociale netwerken"},4:{text:"Domotica"},5:{text:"Eurovisie songfestival"}}};app.el.template.html(e(t))})}},stage4={setup:function(){console.log("Setting up stage 4"),stage4.setLogin()},setLogin:function(){app.login("stage4",function(){stage4.setWelcomeScreen()})},setWelcomeScreen:function(){app.getTemplate("popup",function(e){var t={video:!0,id:"welcomeVideo",videoSrc:"stage1/rabit.mp4",button:{text:"Wat nu? Ga door naar de volgende koffer",action:"stages.listStages()"}};app.el.template.html(e(t))})}},stage5={setup:function(){stage5.createCamera()},createCamera:function(){app.getTemplate("camera",function(e){app.el.template.html(e),stage5.setCamera()})},setLogin:function(){app.login("stage5",function(){})},setCamera:function(){}},pictureSource,destinationType;document.addEventListener("deviceready",onDeviceReady,!1);var app={el:{template:$("#template")},session:{},templateRoot:"views/templates/",setup:function(){app.disableScroll(),app.enableFastClick(),stages.setup()},disableScroll:function(){document.ontouchmove=function(e){e.preventDefault()}},enableFastClick:function(){FastClick.attach(document.body)},getTemplate:function(e,t){var a,n;$.ajax({url:app.templateRoot+e+".html",success:function(e){a=e,n=Handlebars.compile(a),t&&t(n)},error:function(e){var t="Template kan niet geladen worden: ";t+=e.statusText,app.error(t)}})},error:function(e){app.getTemplate("popup",function(t){var a={title:"Er ging iets mis",body:e,button:{action:"window.location.reload()",text:"Probeer opnieuw"},overlay:!0};app.el.template.append(t(a))})},getParameters:function(){var e=window.location.search.substr(1);return null!=e&&""!=e?app.transformToAssocArray(e):{}},transformToAssocArray:function(e){for(var t={},a=e.split("&"),n=0;n<a.length;n++){var o=a[n].split("=");t[o[0]]=o[1]}return t},params:function(){return app.getParameters()},login:function(e,t){keypad.setup({fadeIn:!0,stage:e},function(){keypad.quit(),setTimeout(function(){app.el.template.hide(),t(),app.el.template.fadeIn()},500)})}};app.setup();
//# sourceMappingURL=./app-min.js.map