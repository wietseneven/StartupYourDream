function getObjects(e,t,a){var o=[];for(var s in e)e.hasOwnProperty(s)&&("object"==typeof e[s]?o=o.concat(getObjects(e[s],t,a)):s==t&&e[t]==a&&o.push(e));return o}var interact={user:{check:function(e,t){console.log(e),$.post("https://app.wathebikaande.eu/api/request.php",{type:"user",authCode:e},function(e,a){var e=JSON.parse(e)[0];return app.session.request=e,t(),e})},postStartupChoices:function(e,t,a,o,s){console.log("authcode: "+a),$.post("https://app.wathebikaande.eu/api/request.php",{type:"startups",authCode:e,toUpdate:t,startups:a,stage:2},function(e,t){return console.log(e),app.session.request=e,s&&s(e),e})},getStartupChoices:function(e){}}},keypad={el:{},keys:{key:"",typed:0},commingFrom:"",callback:"",setup:function(e,t){console.log("initiated keypad"),keypad.commingFrom=function(){"stage"+e.stage.setup()},keypad.callback=t,keypad.renderKeypad(e),keypad.keys.key="",keypad.keys.typed=""},renderKeypad:function(e){app.getTemplate("keypad",function(t){console.log("rendering keypad template");var a={};if(e.fadeIn&&(a.hidden=!0),app.el.template.html(t(a)),keypad.assignSelectors(),keypad.watchKeys(),e.fadeIn){var o=0;keypad.el.keys.addClass("hidden"),keypad.el.keys.each(function(){var e=$(this);setTimeout(function(){e.removeClass("hidden")},10*o),o++}),keypad.el.keypad.fadeIn("fast")}})},assignSelectors:function(){keypad.el.keypad=$(".keypad"),keypad.el.keys=$(".keypad .key"),keypad.el.resultBox=$(".keypad .result")},watchKeys:function(){console.log("watching keypad keys"),keypad.el.keys.click(function(){var e=$(this),t=e.data("num");console.log("pressed key "+t),keypad.handleKeyPress(t),3===keypad.keys.typed&&(console.log("3 characters entered, check if user can continue"),keypad.handleSubmit())})},handleKeyPress:function(e){console.log("handling key "+e),keypad.ifUndo(e)?keypad.undoNumber():keypad.ifCancel(e)?keypad.el.keypad.fadeOut("fast",function(){keypad.commingFrom()}):keypad.newNumber(e)},ifUndo:function(e){return"undo"===e},ifCancel:function(e){return"cancel"===e},undoNumber:function(){console.log("Undoing last keypress"),keypad.keys.typed>0&&(keypad.keys.typed--,keypad.keys.key=keypad.keys.key.substring(0,keypad.keys.key.length-1),keypad.el.resultBox.children().last().remove())},newNumber:function(e){keypad.keys.typed<3&&(console.log("Adding new number"),keypad.el.resultBox.append("<span>"+e+"</span>"),keypad.keys.key+=e,keypad.keys.typed++)},hideKeys:function(){var e=0;keypad.el.keys.each(function(){var t=$(this);setTimeout(function(){t.addClass("hidden")},10*e),e++})},handleSubmit:function(){keypad.hideKeys(),keypad.el.resultBox.addClass("loading");var e=interact.user.check(keypad.keys.key,function(){app.session.authCode=keypad.keys.key,keypad.callback&&keypad.callback(e)})},quit:function(){keypad.el.keypad.fadeOut("fast")}},video={el:{},setup:function(e,t){video.el.video=document.getElementById(e),video.click(t),video.el.playBtn=$("#play"),video.el.pauseBtn=$("#pause"),video.el.replayBtn=$("#replay"),video.el.cta=$(".belowPopup")},click:function(e){var t=null!==document.ontouchstart?"click":"touchstart",a=video.el.video;a.addEventListener(t,function(){video.el.replayBtn.fadeOut(),video.el.cta.fadeOut(),1==a.paused?(console.log("videoIsPaused"),video.el.pauseBtn.fadeOut(),video.el.playBtn.fadeIn().delay(300).fadeOut(),a.play()):(console.log("videoIsPlaying"),video.el.pauseBtn.fadeIn(),a.pause())}),a.addEventListener("ended",function(){video.el.replayBtn.fadeIn(),video.el.cta.fadeIn(),e&&e()},!1)}},map={el:{},clickable:!1,startups:!1,popupText:{},setup:function(e,t,a,o){map.loadTemplate(e),t&&(map.clickable=!0),a&&(map.startups=!0),o&&(map.popupText=o)},loadTemplate:function(e){app.getTemplate("map",function(t){"full"==e?app.el.template.html(t):app.el.template.append(t),map.createMapJSON(),map.el.text=$("#text"),map.el.map=$("#map"),setTimeout(function(){map.el.map.animate({opacity:1},200)},500)})},stateNames:[],stateText:[],stateModes:[],countryPaths:[],createMapJSON:function(){function e(){var e=new ScaleRaphael("map",646,654),o={fill:"#d9d9d9",cursor:"pointer",stroke:"#24221f","stroke-width":1,"stroke-linejoin":"round"},s=[];for(var n in paths){var p=e.path(paths[n].path);p.attr(o),s[p.id]=n,"OFF"==map.stateModes[p.id]?p.attr({fill:"#ccc",cursor:"default"}):p.attr({fill:a[p.id],d:"300"})}t(e)}function t(e){var t=.65*$(window).width(),a=.9*$(window).height();e.changeSize(t,a,!0,!1)}var a=[];$.getJSON("assets/data/mapData.json",function(t){app.getTemplate("popup",function(e){var t={title:map.popupText.title,body:map.popupText.body,button:{text:map.popupText.button}};console.dir(map.popupText),map.el.text.html(e(map.popupText))});var o=0;$.each(t.stateData,function(e){var t=this;"ON"==t.stateMode&&o++,map.stateText.push(t.startups),map.stateNames.push(t.stateName),map.stateModes.push(t.stateMode),a.push("#"+t.stateColor)}),e(),map.animateMap()})},animateMap:function(){function e(){setTimeout(function(){$("#"+map.stateNames[o].replace(/\s+/g,"")).attr("data-grown","true"),o++,38>o&&e()},100)}map.countriePaths=map.el.map.find("path");var t={},a=0,o=0;map.countriePaths.each(function(){var e=$(this);t[map.stateNames[a]]={top:e.offset().top,left:e.offset().left},e.attr("id",map.stateNames[a].replace(/\s+/g,"")),e.attr("data-active","false"),a++}),e(),map.startups&&setTimeout(function(){map.getStartups()},100),map.clickable&&map.countryClick()},countryClick:function(){map.countriePaths.click(function(){var e=$(this),t=e.index()-2;"ON"===map.stateModes[t]&&(map.countriePaths.each(function(){$(this).attr("data-active","false")}),e.attr("data-active","true"),app.getTemplate("popup",function(e){var a={title:map.stateNames[t],pros:map.stateText[t],button:{text:"Start hier",action:'stage3.selectedCountry("'+map.stateNames[t]+'")'}};console.dir(a),map.el.text.html(e(a));var o=0;$(".startup").each(function(){var e=$(this),t={x:e.offset().left,y:e.offset().top,width:e.outerWidth(),height:e.outerHeight()};1==o&&(t.x+=t.width),e.css({top:t.y,left:t.x,width:t.width,height:t.height,position:"absolute"}),e.click(function(){$(this).hasClass("open")||map.openModal(e.attr("id"))}),o++})}))})},openModal:function(e){var t=$("#"+e),a={left:t.offset().left,top:t.offset().top,width:t.outerWidth(),height:t.outerHeight()};t.addClass("open");var o=$('<button class="close">Sluiten</button>').click(function(t){t.stopPropagation(),map.closeModal(e,a)});setTimeout(function(){t.find("h4, .linken").fadeIn("fast"),t.find(".content").fadeIn("fast"),t.append(o)},1e3)},closeModal:function(e,t){var a=$("#"+e);a.removeClass("open"),a.find("h4, .linken, .content, .close").fadeOut("fast")},getStartups:function(){$.getJSON("assets/data/startups.json",map.locateStartups)},locateStartups:function(e){$.each(e,function(){var e=this.country,t=$("#"+e),a={x:t.offset().left,y:t.offset().top,width:t[0].getBBox().width,height:t[0].getBBox().height};map.createMarker(a,this),console.log(a)})},createMarker:function(e,t){app.getTemplate("startupMarker",function(a){var o={top:e.y+e.height/2-20,left:e.x+e.width/2-24,name:t.name,logo:t.logo,id:t.id,content:t.content,category:t.category};app.el.template.append(a(o)),$("#marker-"+t.id).click(function(){map.openModal("marker-"+t.id)}),$("#marker-"+t.id+" .linken").click(function(){$this=$(this),$this.hasClass("selected")?map.removeMarker($this):map.selectMarker($this)})})},selectMarker:function(e){e.addClass("selected");var t=e.attr("data-id");console.log("Adding "+t+"-marker to string"),""==map.selectedStartups?map.selectedStartups=t:map.selectedStartups.indexOf(t)<=-1&&(map.selectedStartups+=","+t),stage2.postStartups()},removeMarker:function(e){var t=e.attr("data-id");console.log("Removing "+t+"-marker from string");var a=map.selectedStartups;a=a.replace(","+t,""),a=a.replace(t,""),map.selectedStartups=a,e.removeClass("selected"),stage2.postStartups()},selectedStartups:""},stages={setup:function(){stages.selectStage()},selectStage:function(){var e=app.getParameters().stage;switch(e=Number(e),app.el.template.attr("data-id","stage-"+e),e){case 1:console.log("It's in stage 1"),stage1.setup();break;case 2:console.log("It's in stage 2"),stage2.setup();break;case 3:console.log("It's in stage 3"),stage3.setup();break;case 4:console.log("It's in stage 4"),stage4.setup();break;case 5:console.log("It's in stage 5"),stage5.setup();break;case 6:console.log("It's in stage 6"),stage6.setup();break;case 7:console.log("It's in stage 7"),stage7.setup();break;case 8:console.log("It's in stage 8"),stage8.setup();break;default:console.log("This stage is not defined"),stages.listStages()}},listStages:function(){app.getTemplate("button",function(e){var t={title:"Kies je stage",buttons:{1:{text:"Stage 1",href:"?stage=1"},2:{text:"Stage 2",href:"?stage=2"},3:{text:"Stage 3",href:"?stage=3"},4:{text:"Stage 4",href:"?stage=4"},5:{text:"Stage 5",href:"?stage=5"},6:{text:"Stage 6",href:"?stage=6"},7:{text:"Stage 7",href:"?stage=7"},8:{text:"Stage 8",href:"?stage=8"}}};app.el.template.html(e(t))})}},stage1={setup:function(){console.log("Setting up stage 1"),stage1.setWelcomeScreen()},setWelcomeScreen:function(){app.getTemplate("popup",function(e){console.log("rendering keypad template");var t={title:"Startup your dream",body:"Welkom bij The European Startup Factory!",button:{text:"START JE STARTUP",action:"stage1.setLogin()"},overlay:!1};app.el.template.html(e(t))})},setLogin:function(){app.login("stage1",function(){stage1.setIntroduction()})},setIntroduction:function(e){app.getTemplate("popup",function(e){var t={video:!0,id:"welcomeVideo",videoSrc:"stage1/stage1.mp4",button:{text:"Ga door naar de volgende koffer",action:"stage1.setup()"}};app.el.template.hide(),app.el.template.html(e(t)),app.el.template.fadeIn(),video.setup("welcomeVideo")})}},stage2={setup:function(){console.log("Setting up stage 1"),stage2.setLogin()},setLogin:function(){app.login("stage2",function(){stage2.setMap()})},setMap:function(){console.log("autcode is: "+app.session.authCode);var e={title:"Partners",body:"Als startup is het verstandig om contact te zoeken met andere startups. Kies er 1 van de kaart, en link ermee!"};map.setup("full",!1,!0,e)},postStartups:function(){console.log("Choices = "+map.selectedStartups),interact.user.postStartupChoices(app.session.authCode,"startups",map.selectedStartups,2),app.getTemplate("popup",function(e){var t={video:!0,id:"startupVideo",videoSrc:"stage2/stage2.mp4",button:{text:"Ga door naar de volgende koffer",action:"window.location.reload()"}};app.el.template.children().fadeOut("fast",function(){app.el.template.html(e(t)),video.setup("startupVideo")})})}},stage3={el:{},setup:function(){console.log("Setting up stage 3"),stage3.setLogin()},setLogin:function(){console.log("setting up login in stage 3"),app.login("stage3",function(){stage3.getUserCompanies()})},getUserCompanies:function(){interact.user.postStartupChoices(app.session.authCode,"","",3,function(e){stage3.chooseBussinessCategory()})},chooseBussinessCategory:function(){app.getTemplate("button",function(e){var t={title:"Kies je bedrijfscategorie",id:"stage3catBtns",buttons:[{text:"3d printing"},{text:"Muziek/streaming"},{text:"Sociale netwerken"},{text:"Domotica"},{text:"Eurovisie songfestival"},{text:"Journalistiek"}]};app.el.template.html(e(t)),stage3.el.btngroup=$("#stage3catBtns"),stage3.el.catBtns=stage3.el.btngroup.children(),stage3.watchButtons()})},watchButtons:function(){stage3.el.catBtns.click(function(){var e=$(this),t=e.text();stage3.setBtnGroupHeight(),stage3.el.catBtns.unbind("click"),stage3.el.catBtns.not(e).animate({opacity:0},300),setTimeout(function(){stage3.setPosition(e),stage3.removePopup()},600),interact.user.postStartupChoices(app.session.authCode,"category",t,3,function(e){})})},setBtnGroupHeight:function(){var e=stage3.el.btngroup.height();stage3.el.btngroup.height(228)},setPosition:function(e){e.css({position:"absolute",top:e.offset().top+"px",left:e.offset().left+"px"}).addClass("positionSet"),stage3.setTitlePos(e,!1)},setTitlePos:function(e,t){var a=$(window).width(),o=e.outerWidth(),s=a/2-o/2;t&&(s=.6*a),e.animate({top:"225px",left:s+"px"},500,"swing",function(){if(t){var e=JSON.parse(app.session.request);console.log(e[0].country);var a=e[0].startups;$.getJSON("assets/data/startups.json",function(e){var t=getObjects(e,"id",a);console.log(t[0].country);var o=t[0].country;$("<br><small>Jouw coach "+a+" bevindt zich in "+o+"</small>").appendTo($(".positionSet"))})}else stage3.getMap()})},removePopup:function(){$(".popup").fadeOut("fast")},getMap:function(){var e={video:!0,id:"stage3Video",videoSrc:"stage3/stage3.mp4"};map.setup("append",!0,!1,e),setTimeout(function(){video.setup("stage3Video",function(){map.el.map.fadeIn("fast"),stage3.setTitlePos($(".btn.positionSet"),!0),map.el.text.removeClass("starting")})},1200)},selectedCountry:function(e){interact.user.postStartupChoices(app.session.authCode,"country",e,3),app.el.template.children().fadeOut("fast",function(){app.getTemplate("popup",function(e){var t={title:"Goede keuze!",button:{text:"Ga door naar de volgende koffer",action:"window.location.reload()"}};app.el.template.html(e(t))})})}},stage4={setup:function(){console.log("Setting up stage 4"),stage4.setLogin()},setLogin:function(){app.login("stage4",function(){stage4.setWelcomeScreen()})},setWelcomeScreen:function(){app.getTemplate("popup",function(e){var t={video:!0,id:"stage4Video",videoSrc:"stage4/stage4.mp4",button:{text:"Het gaat super met je "+app.session.request.category+" startup! Ga naar de volgende koffer",action:"stage4.setup()"}};app.el.template.html(e(t)),video.setup("stage4Video"),console.log(app.session.request)})}},stage5={setup:function(){console.log("Setting up stage 5"),stage5.setLogin()},setLogin:function(){app.login("stage5",function(){stage5.setWelcomeScreen()})},setWelcomeScreen:function(){app.getTemplate("popup",function(e){var t={video:!0,id:"neelieVideo",videoSrc:"stage5/stage5.mp4",button:{text:"Hoe gaat het ondertussen met jouw "+app.session.request.category+" startup? Ga door naar de volgende koffer",action:"stage5.setLogin()"}};app.el.template.html(e(t)),video.setup("neelieVideo")})}},stage6={setup:function(){console.log("Setting up stage 6"),stage6.setLogin()},setLogin:function(){app.login("stage6",function(){stage6.setWelcomeScreen()})},setWelcomeScreen:function(){app.getTemplate("popup",function(e){var t={video:!0,id:"stage6Video",videoSrc:"stage6/stage6.mp4",button:{text:"Het gaat niet goed! Wat nu? Ga door naar de volgende koffer",action:"window.location.reload()"}};app.el.template.html(e(t)),video.setup("stage6Video")})}},stage7={setup:function(){console.log("Setting up stage 7"),stage7.setLogin()},setLogin:function(){app.login("stage7",function(){stage7.setWelcomeScreen()})},setWelcomeScreen:function(){app.getTemplate("popup",function(e){var t={video:!0,id:"stage7Video",videoSrc:"stage7/stage7.mp4",button:{text:"Gelukkig! Ga door naar de volgende koffer",action:"stages.listStages()"}};app.el.template.html(e(t)),video.setup("stage7Video")})}},stage8={setup:function(){console.log("Setting up stage 7"),stage8.setLogin()},setLogin:function(){app.login("stage8",function(){stage8.setWelcomeScreen()})},setWelcomeScreen:function(){app.getTemplate("popup",function(e){var t={video:!0,id:"stage8Video",videoSrc:"stage8/stage8.mp4",button:{text:"Wat nu? Ga door naar de volgende koffer",action:"stages.listStages()"}};app.el.template.html(e(t)),video.setup("stage8Video")})}},app={el:{template:$("#template")},session:{},templateRoot:"views/templates/",setup:function(){app.disableScroll(),app.enableFastClick(),stages.setup()},disableScroll:function(){document.ontouchmove=function(e){e.preventDefault()}},enableFastClick:function(){FastClick.attach(document.body)},getTemplate:function(e,t){var a,o;$.ajax({url:app.templateRoot+e+".html",success:function(e){a=e,o=Handlebars.compile(a),t&&t(o)},error:function(e){var t="Template kan niet geladen worden: ";t+=e.statusText,app.error(t)}})},error:function(e){app.getTemplate("popup",function(t){var a={title:"Er ging iets mis",body:e,button:{action:"window.location.reload()",text:"Probeer opnieuw"},overlay:!0};app.el.template.append(t(a))})},getParameters:function(){var e=window.location.search.substr(1);return null!=e&&""!=e?app.transformToAssocArray(e):{}},transformToAssocArray:function(e){for(var t={},a=e.split("&"),o=0;o<a.length;o++){var s=a[o].split("=");t[s[0]]=s[1]}return t},params:function(){return app.getParameters()},login:function(e,t){keypad.setup({fadeIn:!0,stage:e},function(){keypad.quit(),setTimeout(function(){app.el.template.hide(),t(),app.el.template.fadeIn()},500)})}};app.setup();
//# sourceMappingURL=./app-min.js.map